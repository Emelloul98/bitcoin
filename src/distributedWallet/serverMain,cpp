#include "ParticipantServer.h"

int main(int argc, char* argv[]) {
    if (argc < 2 || argc > 3) {
        std::cerr << "Usage: ./server <port> [num_participants]\n";
        return 1;
    }

    int port = std::stoi(argv[1]);

    if (argc == 3) {
        int n = std::stoi(argv[2]);
        create_DB(n);
    }

    group = EC_GROUP_new_by_curve_name(NID_secp256k1);
    order = BN_new();
    EC_GROUP_get_order(group, order, nullptr);
    ctx = BN_CTX_new();

    run_server(port);

    BN_free(order);
    EC_GROUP_free(group);
    BN_CTX_free(ctx);
}
